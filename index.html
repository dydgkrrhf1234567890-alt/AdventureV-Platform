<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ADVC Empire (Polygon)</title>
    <style>
        body {
            background-color: #050505; color: #00ffcc;
            font-family: 'Courier New', Courier, monospace;
            text-align: center; margin: 0; padding: 0;
            display: flex; flex-direction: column; justify-content: center; align-items: center;
            min-height: 100vh;
            background-image: radial-gradient(circle at 50% 50%, #1a1a1a 0%, #000000 100%);
            user-select: none;
        }
        h1 { font-size: 2.0rem; text-shadow: 0 0 15px #00ffcc; margin-bottom: 5px; }
        .container { width: 90%; max-width: 400px; padding: 20px; display: flex; flex-direction: column; align-items: center; margin-top: 80px; }
        .score-board { font-size: 1.6rem; color: #ffd700; text-shadow: 0 0 10px #ffd700; margin: 20px 0 5px 0; font-weight: bold; word-break: break-all; }
        .score-sub { font-size: 0.8rem; color: #666; margin-bottom: 30px; }
        
        /* ì½”ì–´ ë””ìì¸ */
        .ai-core {
            width: 150px; height: 150px;
            background: radial-gradient(circle at 30% 30%, #ff00cc, #660066);
            border-radius: 50%; box-shadow: 0 0 30px #ff00cc;
            cursor: pointer; transition: transform 0.1s; margin-bottom: 30px; border: 2px solid #ff66ff;
        }
        .ai-core:active { transform: scale(0.95); }

        /* ë²„íŠ¼ ìŠ¤íƒ€ì¼ */
        #connect-btn, #claim-btn, .shop-btn {
            background: transparent; border: 1px solid #ff6600; color: #ff6600;
            padding: 10px 20px; cursor: pointer; font-family: inherit; margin-bottom: 20px; border-radius: 5px; font-weight: bold;
            text-decoration: none; display: inline-block;
        }
        #claim-btn { border-color: #333; color: #555; pointer-events: none; }
        
        /* ìƒì  ë²„íŠ¼ (ìœ ë‹ˆì½˜) */
        .shop-btn {
            border-color: #ff00cc; color: #ff00cc; margin-top: 10px;
        }
        .shop-btn:hover {
            background-color: #ff00cc; color: #000; box-shadow: 0 0 15px #ff00cc;
        }
    </style>
</head>
<body>
    <div style="width: 100%; background-color: #000; color: #FFD700; text-align: center; padding: 15px 0; border-bottom: 2px solid #FFD700; font-family: monospace; position: absolute; top: 0;">
        <h2 style="margin: 0; text-shadow: 0 0 10px #FFD700;">âœ¨ ADVC REAL-NET âœ¨</h2>
        <p style="margin: 5px 0 0 0; font-size: 0.9em;">System: Polygon Network (POL)</p>
    </div>

    <div class="container">
        <button id="connect-btn" onclick="window.connectWallet()">ğŸ¦Š Connect Wallet</button>
        
        <h1>MY ADVC</h1>
        <div class="score-board" id="balance-display">--- ADVC</div>
        <div class="score-sub" id="status-msg">ì§€ê°‘ ì—°ê²° ë° ë„¤íŠ¸ì›Œí¬ í™•ì¸ ì¤‘...</div>
        
        <button id="claim-btn" onclick="window.sendTestTransaction()">ğŸ’¸ Test Send (0.1)</button>
        
        <div class="ai-core"></div>

        <a href="https://dapp.quickswap.exchange/swap/best/ETH/0x5b41e1f16507834B42E503e79761dd2CC218Cb5A" target="_blank" class="shop-btn">ğŸ¦„ Buy ADVC (ê±°ë˜ì†Œ ì´ë™)</a>
    </div>

    <script type="module">
        import { ethers } from "https://cdnjs.cloudflare.com/ajax/libs/ethers/5.7.2/ethers.esm.min.js";

        const tokenAddress = "0x5b41e1f16507834B42E503e79761dd2CC218Cb5A"; 
        const tokenDecimals = 18;
        const tokenABI = [
            "function balanceOf(address owner) view returns (uint256)",
            "function transfer(address to, uint256 amount) returns (bool)"
        ];

        let provider, signer, tokenContract, userAddress;

        // [í•µì‹¬] í´ë¦¬ê³¤ ê°•ì œ ì „í™˜ í•¨ìˆ˜
        async function switchToPolygon() {
            try {
                await window.ethereum.request({
                    method: 'wallet_switchEthereumChain',
                    params: [{ chainId: '0x89' }], // Polygon Mainnet ID
                });
            } catch (error) {
                if (error.code === 4902) {
                    await window.ethereum.request({
                        method: 'wallet_addEthereumChain',
                        params: [{
                            chainId: '0x89',
                            chainName: 'Polygon Mainnet',
                            rpcUrls: ['https://polygon-rpc.com/']
                        }],
                    });
                }
            }
        }

        window.connectWallet = async function() {
            if (!window.ethereum) { alert("ë©”íƒ€ë§ˆìŠ¤í¬ ì•± ë¸Œë¼ìš°ì €ë¥¼ ì‚¬ìš©í•´ì£¼ì„¸ìš”!"); return; }

            try {
                // 1. ë„¤íŠ¸ì›Œí¬ ë§ì¶”ê¸°
                await switchToPolygon();

                provider = new ethers.providers.Web3Provider(window.ethereum);
                await provider.send("eth_requestAccounts", []);
                signer = provider.getSigner();
                userAddress = await signer.getAddress();

                document.getElementById("connect-btn").innerText = "Connected!";
                document.getElementById("connect-btn").style.borderColor = "#00FF00";
                document.getElementById("connect-btn").style.color = "#00FF00";
                
                document.getElementById("balance-display").innerText = "Loading...";

                tokenContract = new ethers.Contract(tokenAddress, tokenABI, signer);
                
                // 2. ì”ì•¡ ì¡°íšŒ
                const balance = await tokenContract.balanceOf(userAddress);
                const formattedBalance = ethers.utils.formatUnits(balance, tokenDecimals);
                const displayNum = Number(formattedBalance).toLocaleString(undefined, {maximumFractionDigits: 2});
                
                document.getElementById("balance-display").innerText = displayNum + " ADVC";
                document.getElementById("status-msg").innerText = "âœ… Polygon Network Connected";
                
                const cBtn = document.getElementById("claim-btn");
                cBtn.style.borderColor = "#ffd700"; cBtn.style.color = "#ffd700"; cBtn.style.pointerEvents = "auto";

            } catch (err) {
                alert("ì˜¤ë¥˜ ë°œìƒ: " + err.message);
                document.getElementById("balance-display").innerText = "Error";
            }
        };

        window.sendTestTransaction = async function() {
            try {
                const amount = "0.1"; // 0.1ê°œ ê³ ì • ì „ì†¡ í…ŒìŠ¤íŠ¸
                const parseAmount = ethers.utils.parseUnits(amount, tokenDecimals);
                alert("ê°€ìŠ¤ë¹„ ìŠ¹ì¸ ì°½ì´ ëœ¨ë©´ 'í™•ì¸'ì„ ëˆŒëŸ¬ì£¼ì„¸ìš”.");
                const tx = await tokenContract.transfer(userAddress, parseAmount);
                alert("ì „ì†¡ ì‹œì‘! Hash: " + tx.hash);
            } catch (err) {
                alert("ì „ì†¡ ì·¨ì†Œ ë˜ëŠ” ì‹¤íŒ¨");
            }
        };
    </script>
</body>
</html>
